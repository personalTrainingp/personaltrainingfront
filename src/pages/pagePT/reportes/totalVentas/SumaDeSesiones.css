
.tabla-sesiones {
  --color-borde-principal: #000;
  --color-borde-rojo: red;
  --color-fondo-header: #c00000;
  --color-texto-header: #fff;
  --color-texto-rojo: #c00000;
  --columnas-programa: 4; /* NUEVOS, RENOV, REINSC, CANJE */

  border-collapse: collapse;
}

/* ================== 2. BORDES GLOBALES ================== */
.tabla-sesiones th,
.tabla-sesiones td {
  border: 1px solid var(--color-borde-principal) !important;
  box-sizing: border-box;
}

/* ================== 3. HEADER (THEAD) ================== */

/* --- Fila 1 del THEAD (Logos y Títulos) --- */
.tabla-sesiones thead tr:first-child th:first-child,
.tabla-sesiones thead tr:first-child th:nth-last-child(1),
.tabla-sesiones thead tr:first-child th:nth-last-child(2),
.tabla-sesiones thead tr:first-child th:nth-last-child(3) {
  background: var(--color-fondo-header) !important;
  color: var(--color-texto-header) !important;
}
.tabla-sesiones thead tr:first-child th.triptych-head {
  background: #fff !important;
}

/* --- Fila 2 del THEAD (Subtítulos y Celdas Vacías) --- */
.tabla-sesiones thead tr:nth-child(2) th.triptych-head {
  background: var(--color-fondo-header) !important;
  color: var(--color-texto-header) !important;
}
.tabla-sesiones thead tr:nth-child(2) th:first-child,
.tabla-sesiones thead tr:nth-child(2) th:nth-last-child(1),
.tabla-sesiones thead tr:nth-child(2) th:nth-last-child(2),
.tabla-sesiones thead tr:nth-child(2) th:nth-last-child(3) {
  background: var(--color-fondo-header) !important;
  border: none !important;
}

/* --- Limpieza de bordes del THEAD (para eliminar la línea negra) --- */
.tabla-sesiones thead tr:first-child th {
  border-bottom: none !important;
}
.tabla-sesiones thead tr:nth-child(2) th {
  border-top: none !important;
}

/* Texto de sub-cabeceras (NUEVOS, RENOV...) */
.miniTitle {
  font-weight: 800;
  font-size: 15px;
  letter-spacing: 0.3px;
  margin: 0;
  color: var(--color-texto-header) !important;
}

/* ================== 4. CELDAS DE PROGRAMAS (TRIPTYCH) ================== */
.tabla-sesiones :is(th.triptych-head, td.triptych) {
  position: relative;
  width: 90px;
  min-width: 90px;
  max-width: 100px;
  padding: 0;
}

/*
 * ================== CAMBIO CLAVE 1 ==================
 * El grid interno (caja de 4 columnas).
 * Debe tener position: relative y un z-index ALTO
 * para que el texto/logos se sienten ENCIMA de las líneas.
*/
.tabla-sesiones th.triptych-head > .tri-box-head,
.tabla-sesiones td.triptych > .tri-box {
  position: relative; /* <--- AÑADIDO */
  z-index: 2; /* <--- AÑADIDO (Pone el contenido arriba) */
  display: grid;
  grid-template-columns: repeat(var(--columnas-programa), 1fr);
  height: 100%;
}

.tabla-sesiones tbody td.triptych > .tri-box {
  background: #fff;
}
.tabla-sesiones th.triptych-head > .tri-box-head > div,
.tabla-sesiones td.triptych > .tri-box > div {
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  z-index: 1; /* z-index relativo al .tri-box */
}

/*
 * ================== CAMBIO CLAVE 2 ==================
 * BORDES ROJOS INTERNOS (El hack del linear-gradient)
 * El ::before ahora tiene z-index: 1.
 * Esto lo pone ENCIMA del background de la celda (z-index: 0)
 * pero DEBAJO del contenido del .tri-box (z-index: 2).
*/
.tabla-sesiones :is(th.triptych-head, td.triptych)::before {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 1; /* <--- CAMBIADO (Pone las líneas encima del fondo) */

  --ancho-linea: 2px;
  --pos-linea-1: calc(100% / var(--columnas-programa));
  --pos-linea-2: calc(2 * (100% / var(--columnas-programa)));
  --pos-linea-3: calc(3 * (100% / var(--columnas-programa)));

  background-image: linear-gradient(
    to right,
    transparent calc(var(--pos-linea-1) - var(--ancho-linea) / 2),
    var(--color-borde-rojo) calc(var(--pos-linea-1) - var(--ancho-linea) / 2),
    var(--color-borde-rojo) calc(var(--pos-linea-1) + var(--ancho-linea) / 2),
    transparent calc(var(--pos-linea-1) + var(--ancho-linea) / 2),
    transparent calc(var(--pos-linea-2) - var(--ancho-linea) / 2),
    var(--color-borde-rojo) calc(var(--pos-linea-2) - var(--ancho-linea) / 2),
    var(--color-borde-rojo) calc(var(--pos-linea-2) + var(--ancho-linea) / 2),
    transparent calc(var(--pos-linea-2) + var(--ancho-linea) / 2),
    transparent calc(var(--pos-linea-3) - var(--ancho-linea) / 2),
    var(--color-borde-rojo) calc(var(--pos-linea-3) - var(--ancho-linea) / 2),
    var(--color-borde-rojo) calc(var(--pos-linea-3) + var(--ancho-linea) / 2),
    transparent calc(var(--pos-linea-3) + var(--ancho-linea) / 2)
  );
}

/*
 * ================== CAMBIO CLAVE 3 ==================
 * Conectar las líneas entre las filas del header.
 * Hacemos que el ::before de la fila 1 "sangre" 1px hacia abajo.
 * Hacemos que el ::before de la fila 2 "sangre" 1px hacia arriba.
 * Esto hace que las líneas se superpongan y parezcan una sola.
*/
.tabla-sesiones thead tr:first-child th.triptych-head::before {
  bottom: -1px; /* Sangra 1px hacia abajo */
}
.tabla-sesiones thead tr:nth-child(2) th.triptych-head::before {
  top: -1px; /* Sangra 1px hacia arriba */
}

/* ================== 5. BORDES ROJOS EXTERNOS ================== */

/* Borde rojo GRUESO a la IZQUIERDA de CADA bloque de programa */
.tabla-sesiones :is(th, td).program-start {
  border-left: 2px solid var(--color-borde-rojo) !important;
}

/* Borde rojo GRUESO a la DERECHA del ÚLTIMO bloque de programa */
.tabla-sesiones :is(th, td).program-end {
  border-right: 2px solid var(--color-borde-rojo) !important;
}

/* Borde rojo GRUESO a la IZQUIERDA de las 3 columnas de totales */
.tabla-sesiones :is(th, td):nth-last-child(1), /* % */
.tabla-sesiones :is(th, td):nth-last-child(2), /* s/. */
.tabla-sesiones :is(th, td):nth-last-child(3)  /* TOTAL SOCIOS */ {
  border-left: 2px solid var(--color-borde-rojo) !important;
}

/* ================== 6. ESTILOS DE CELDAS (ASESOR, TROFEO, ETC.) ================== */

.tabla-sesiones td.img-with-name .img-cap {
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  padding: 0.25rem 0;
}
.tabla-sesiones td.img-with-name .img-cap img {
  width: 80px;
  height: 100px;
  border-radius: 10px;
  object-fit: cover;
  background: #f3f3f3;
}
.tabla-sesiones td.img-with-name .cap {
  font-weight: 800;
  font-size: 20px;
  text-align: center;
}

.tabla-sesiones .copa-champions {
  position: absolute;
  top: 5px;
  left: -10px;
  z-index: 3;
}
.tabla-sesiones .copa-champions img {
  width: 70px;
  filter: brightness(1.1) contrast(1.3) drop-shadow(0 2px 3px rgba(0, 0, 0, 0.4));
}

.tabla-sesiones td.triptych > .tri-box > div p {
  margin: 0;
  padding: 2px 0;
  font-size: 17px;
  font-weight: 400;
}

/* ================== 7. FILAS SECUNDARIAS (SOCIOS Y TOTAL) ================== */

/* Texto rojo para todas las filas con .fw-bold */
.tabla-sesiones.table > :not(caption) > * > *.fw-bold {
  color: var(--color-texto-rojo) !important;
}

/* FIX para la fila TOTAL (los números no estaban rojos) */
.tabla-sesiones tbody tr.fila-total td {
  color: var(--color-texto-rojo) !important;
  font-weight: 800 !important;
}

/* Fila "SOCIOS POR CANAL DE VENTA" */
.tabla-sesiones tbody tr.fila-secundaria td.img-with-name {
  background: var(--color-fondo-header) !important;
  color: var(--color-texto-header) !important;
}
.tabla-sesiones td.img-with-name.only-text .cap {
  font-size: 22px;
  line-height: 1.5;
  padding: 8px 4px;
  white-space: normal !important;
  word-break: break-word !important;
  text-align: center;
  font-weight: 800;
}

/* Fila "TOTAL" con bordes rojos superior/inferior */
.tabla-sesiones tbody tr.fila-total {
  position: relative;
  box-shadow: inset 0 2px 0 var(--color-borde-rojo),
    inset 0 -2px 0 var(--color-borde-rojo);
}

/* Estilos para la fila "SOCIOS POR CANAL" */
.fila-secundaria.compact td,
.fila-secundaria.compact td * {
  font-size: 29px !important;
  line-height: 1.1 !important;
}
.fila-secundaria.compact td {
  padding: 14px 16px !important;
}
.fila-secundaria.compact .img-with-name .cap {
  font-size: 22px !important;
  line-height: 1.5 !important;
  margin: 0 !important;
}
.fila-secundaria.compact .triptych {
  padding: 0 !important;
}
.fila-secundaria.compact .tri-box {
  display: grid !important;
  grid-template-columns: repeat(var(--columnas-programa), 1fr) !important;
  gap: 2px !important;
}
/* El fondo blanco va en la celda */
.tabla-sesiones tbody td.triptych {
  background: #fff;
}

/* El contenedor interno transparente,
   así no tapa las líneas */
.tabla-sesiones tbody td.triptych > .tri-box {
  background: transparent; /* antes era #fff */
}

/* Mantén esto: la línea entre fondo y contenido */
.tabla-sesiones :is(th.triptych-head, td.triptych)::before {
  z-index: 1;
}
.tabla-sesiones th.triptych-head > .tri-box-head,
.tabla-sesiones td.triptych > .tri-box {
  z-index: 2;
}

/*OTRA VISTA*/

/* avatar-col: sin subdivisiones */
.tabla-sesiones th.avatar-col::before,
.tabla-sesiones th.avatar-col::after{ display:none !important; }

/* ================== Ranking (scopeado) ================== */
.ranking-card .rank-avatar{ position:relative; display:inline-flex; align-items:center; justify-content:center; width:140px; height:100px; overflow:hidden; }
.ranking-card .rank-avatar .avatar{ width:90px; height:90px; object-fit:cover; border-radius:8px; background:#f3f3f3; }
.ranking-card .copa-champions{ position:absolute; top:5px; left:-10px; z-index:3; }
.ranking-card .copa-champions img{ width:65px; height:75px; filter:brightness(1.1) contrast(1.3) drop-shadow(0 2px 3px rgba(0,0,0,.4)); mix-blend-mode:darken; }
.ranking-card .table-centered :is(thead th:nth-child(2), tbody td:nth-child(2)){ width:160px; }
.ranking-card .rank-img-cell{ width:170px; min-width:170px; padding:8px 12px; vertical-align:middle; }
.ranking-card .rank-img-cell .img-cap{ position:relative; display:flex; align-items:center; justify-content:center; gap:.5rem; height:110px; }
.ranking-card .rank-img-cell .avatar{ width:90px; height:110px; border-radius:10px; object-fit:cover; background:#f3f3f3; }

/* util */
.tabla-sesiones .is-bold{ font-weight:800; }
/* ====== FIX: centrar título del ranking sí o sí ====== */
.ranking-card .card-body {
  display: block !important;
}

.ranking-card .ranking-title {
  display: block !important;
  width: 100% !important;
  margin: 0 0 1rem 0 !important;
  text-align: center !important;
}
